![1754213491160](image/03.gRPC-work/1754213491160.png)

## ‚úÖ **RPC (Remote Procedure Call) l√† g√¨ v√† t·∫°i sao g·ªçi l√† "Remote"?**

- **RPC** l√† m√¥ h√¨nh cho ph√©p m·ªôt ch∆∞∆°ng tr√¨nh g·ªçi m·ªôt h√†m ho·∫∑c th·ªß t·ª•c n·∫±m ·ªü **m·ªôt m√°y ch·ªß kh√°c (remote server)** nh∆∞ th·ªÉ n√≥ l√† m·ªôt h√†m c·ª•c b·ªô.
- T·ª´ g√≥c ƒë·ªô c·ªßa l·∫≠p tr√¨nh vi√™n, n√≥ gi·ªëng nh∆∞:

  ```go
  paymentService.ChargeCard(userId, amount)
  ```

  nh∆∞ng th·ª±c t·∫ø l√† l·ªùi g·ªçi n√†y s·∫Ω **ƒë∆∞·ª£c m√£ h√≥a, g·ª≠i qua m·∫°ng** , th·ª±c thi ·ªü ph√≠a server, sau ƒë√≥ k·∫øt qu·∫£ ƒë∆∞·ª£c **g·ª≠i ng∆∞·ª£c l·∫°i** .

---

## üåê **T·∫°i sao RPC ph·ªï bi·∫øn trong microservices?**

- Microservices th∆∞·ªùng ƒë∆∞·ª£c tri·ªÉn khai tr√™n c√°c server kh√°c nhau ‚Üí c·∫ßn **giao ti·∫øp qua m·∫°ng** .
- RPC gi√∫p ƒë∆°n gi·∫£n h√≥a vi·ªác g·ªçi qua m·∫°ng ‚Üí gi·ªëng nh∆∞ g·ªçi h√†m c·ª•c b·ªô.
- **gRPC** l√† m·ªôt trong nh·ªØng framework RPC ph·ªï bi·∫øn nh·∫•t hi·ªán nay, s·ª≠ d·ª•ng:
  - **Protocol Buffers (protobuf)** ƒë·ªÉ encode d·ªØ li·ªáu d·∫°ng nh·ªã ph√¢n
  - **HTTP/2** l√†m giao th·ª©c truy·ªÅn t·∫£i ‚Üí h·ªó tr·ª£ multiplexing, low-latency

---

## üß≠ **Gi·∫£i th√≠ch s∆° ƒë·ªì d·ªØ li·ªáu gRPC t·ª´ client ƒë·∫øn server**

---

### ‚úÖ **Step 1: Client g·ªçi REST API**

- Tr√¨nh duy·ªát ho·∫∑c ·ª©ng d·ª•ng frontend g·ª≠i request d·∫°ng **HTTP + JSON** ƒë·∫øn Order Service.
- V√≠ d·ª•: `POST /order` v·ªõi body:
  ```json
  { "userId": 123, "amount": 50 }
  ```

---

### ‚úÖ **Steps 2 - 4: Order Service (gRPC Client) chu·∫©n b·ªã RPC call**

- **Order Service** nh·∫≠n request REST ‚Üí chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu JSON sang **protobuf format** .
- G·ªçi ƒë·∫øn h√†m client stub c·ªßa gRPC:
  ```go
  paymentClient.Charge(userId, amount)
  ```
- gRPC **m√£ h√≥a request th√†nh nh·ªã ph√¢n** , v√† g·ª≠i xu·ªëng t·∫ßng transport.

---

### ‚úÖ **Step 5: G·ª≠i d·ªØ li·ªáu qua HTTP/2**

- gRPC s·ª≠ d·ª•ng **HTTP/2** ƒë·ªÉ g·ª≠i packet ƒëi ‚Üí t·ªëi ∆∞u v·ªÅ t·ªëc ƒë·ªô, ƒëa lu·ªìng, v√† hi·ªáu qu·∫£ h∆°n HTTP/1.1.
- So v·ªõi JSON + REST, **gRPC nhanh h∆°n g·∫•p ~5 l·∫ßn** nh·ªù:
  - D·ªØ li·ªáu nh·ªã ph√¢n nh·∫π h∆°n
  - √çt t·ªën CPU v√† bƒÉng th√¥ng
  - HTTP/2 h·ªó tr·ª£ multiplex (nhi·ªÅu stream tr√™n 1 k·∫øt n·ªëi TCP)

---

### ‚úÖ **Steps 6 - 8: Payment Service (gRPC Server) x·ª≠ l√Ω**

- gRPC server **nh·∫≠n packet** , gi·∫£i m√£ t·ª´ binary th√†nh object protobuf.
- G·ªçi v√†o logic ·ª©ng d·ª•ng ph√≠a server, v√≠ d·ª•:
  ```go
  func (s *PaymentServer) Charge(...) { ... }
  ```

---

### ‚úÖ **Steps 9 - 11: Tr·∫£ k·∫øt qu·∫£ v·ªÅ client**

- Server x·ª≠ l√Ω xong s·∫Ω tr·∫£ v·ªÅ object protobuf ‚Üí gRPC **m√£ h√≥a th√†nh binary** .
- G·ª≠i ng∆∞·ª£c l·∫°i v·ªÅ ph√≠a Order Service qua HTTP/2.

---

### ‚úÖ **Steps 12 - 14: Order Service tr·∫£ k·∫øt qu·∫£ cho client**

- Order Service **gi·∫£i m√£ protobuf** , chuy·ªÉn th√†nh JSON (n·∫øu c·∫ßn).
- Tr·∫£ l·∫°i cho frontend d∆∞·ªõi d·∫°ng response HTTP nh∆∞ b√¨nh th∆∞·ªùng.

---

## üß† **T√≥m t·∫Øt ƒëi·ªÉm m·∫°nh c·ªßa gRPC so v·ªõi REST:**

| Ti√™u ch√≠         | REST (HTTP/JSON)   | gRPC (HTTP/2 + Protobuf)           |
| ---------------- | ------------------ | ---------------------------------- |
| **T·ªëc ƒë·ªô**       | Ch·∫≠m h∆°n           | ‚úÖ Nhanh h∆°n (binary)              |
| **ƒê·ªãnh d·∫°ng**    | JSON               | ‚úÖ Protobuf (nh·∫π h∆°n)              |
| **Streaming**    | Kh√¥ng t·ªëi ∆∞u       | ‚úÖ H·ªó tr·ª£ bidirectional            |
| **Code gen**     | Kh√¥ng t·ª± sinh code | ‚úÖ Sinh stub client/server t·ª± ƒë·ªông |
| **H·ªá sinh th√°i** | Ph·ªï bi·∫øn, ƒë∆°n gi·∫£n | C·∫ßn setup th√™m                     |

---

## üü¶ **K·∫øt lu·∫≠n khi tr·∫£ l·ªùi ph·ªèng v·∫•n:**

> ‚ÄúgRPC gi√∫p c√°c service giao ti·∫øp v·ªõi nhau m·ªôt c√°ch hi·ªáu qu·∫£ trong m√¥i tr∆∞·ªùng microservices. So v·ªõi REST, gRPC mang l·∫°i **hi·ªáu su·∫•t cao h∆°n** , **truy·ªÅn d·ªØ li·ªáu nh·∫π h∆°n** , v√† h·ªó tr·ª£ nhi·ªÅu t√≠nh nƒÉng nh∆∞ **streaming, code generation** . N√≥ gi√∫p ch√∫ng ta giao ti·∫øp qua m·∫°ng nh∆∞ g·ªçi h√†m n·ªôi b·ªô, nh∆∞ng v·∫´n ƒë·∫£m b·∫£o hi·ªáu qu·∫£, m·ªü r·ªông, v√† chu·∫©n h√≥a.‚Äù
