### 1. Imperative vs. Declarative - Hai "TrÆ°á»ng phÃ¡i" Quáº£n lÃ½

HÃ£y dÃ¹ng má»™t phÃ©p so sÃ¡nh Ä‘Æ¡n giáº£n Ä‘á»ƒ hiá»ƒu rÃµ hai trÆ°á»ng phÃ¡i nÃ y:

- **Imperative (Má»‡nh lá»‡nh) - Giá»‘ng nhÆ° báº¡n Ä‘i Taxi truyá»n thá»‘ng ğŸš•:**

  - Báº¡n pháº£i chá»‰ Ä‘Æ°á»ng tá»«ng bÆ°á»›c cho tÃ i xáº¿: "Äi tháº³ng, Ä‘áº¿n ngÃ£ tÆ° ráº½ pháº£i, Ä‘i thÃªm 200m rá»“i ráº½ trÃ¡i...".
  - Báº¡n chá»‰ rÃµ **CÃI GÃŒ** cáº§n lÃ m vÃ  quan trá»ng hÆ¡n lÃ  **LÃ€M THáº¾ NÃ€O** Ä‘á»ƒ lÃ m Ä‘iá»u Ä‘Ã³.

- **Declarative (Khai bÃ¡o) - Giá»‘ng nhÆ° báº¡n Ä‘áº·t xe Uber/Grab ğŸš—:**

  - Báº¡n chá»‰ cáº§n nháº­p vÃ o Ä‘iá»ƒm Ä‘áº¿n cuá»‘i cÃ¹ng: "ÄÆ°a tÃ´i Ä‘áº¿n nhÃ  hÃ¡t lá»›n".
  - Há»‡ thá»‘ng (tÃ i xáº¿ vÃ  á»©ng dá»¥ng) sáº½ tá»± tÃ¬m ra con Ä‘Æ°á»ng tá»‘i Æ°u nháº¥t Ä‘á»ƒ Ä‘Æ°a báº¡n Ä‘áº¿n Ä‘Ã³.
  - Báº¡n chá»‰ nÃ³i **CÃI GÃŒ** báº¡n muá»‘n (tráº¡ng thÃ¡i cuá»‘i cÃ¹ng), cÃ²n **cÃ¡ch lÃ m** Ä‘Ã£ cÃ³ há»‡ thá»‘ng lo.

---

### 2. Ãp dá»¥ng vÃ o Kubernetes

Trong Kubernetes, hai trÆ°á»ng phÃ¡i nÃ y Ä‘Æ°á»£c thá»ƒ hiá»‡n qua cÃ¡ch báº¡n sá»­ dá»¥ng lá»‡nh `kubectl`.

#### a. CÃ¡ch tiáº¿p cáº­n Má»‡nh lá»‡nh (Imperative Approach)

ÄÃ¢y lÃ  cÃ¡ch báº¡n ra lá»‡nh trá»±c tiáº¿p cho Kubernetes pháº£i lÃ m gÃ¬. NÃ³ cÃ³ 2 dáº¡ng:

1. **DÃ¹ng lá»‡nh trá»±c tiáº¿p (Pure Imperative Commands):**

   - **Táº¡o má»›i:** `kubectl run`, `kubectl create deployment`, `kubectl expose`.
   - **Cáº­p nháº­t:** `kubectl edit`, `kubectl scale`, `kubectl set image`.
   - **Æ¯u Ä‘iá»ƒm:** Ráº¥t nhanh vÃ  tiá»‡n lá»£i cho cÃ¡c tÃ¡c vá»¥ Ä‘Æ¡n giáº£n, Ä‘áº·c biá»‡t há»¯u Ã­ch khi lÃ m bÃ i thi CKA Ä‘á»ƒ tiáº¿t kiá»‡m thá»i gian.
   - **NhÆ°á»£c Ä‘iá»ƒm:** KhÃ³ theo dÃµi (chá»‰ lÆ°u trong lá»‹ch sá»­ dÃ²ng lá»‡nh), khÃ´ng phÃ¹ há»£p cho mÃ´i trÆ°á»ng lÃ m viá»‡c nhÃ³m, giá»›i háº¡n chá»©c nÄƒng vá»›i cÃ¡c yÃªu cáº§u phá»©c táº¡p.

2. **DÃ¹ng file cáº¥u hÃ¬nh (nhÆ°ng vá»›i lá»‡nh má»‡nh lá»‡nh):**

   - **Táº¡o má»›i:** `kubectl create -f my-pod.yaml`
   - **Cáº­p nháº­t:** `kubectl replace -f my-pod.yaml`
   - **XÃ³a:** `kubectl delete -f my-pod.yaml`
   - **Váº¥n Ä‘á»:** CÃ¡ch nÃ y váº«n lÃ  má»‡nh lá»‡nh vÃ¬ **báº¡n** pháº£i biáº¿t tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a há»‡ thá»‘ng Ä‘á»ƒ chá»n Ä‘Ãºng lá»‡nh. VÃ­ dá»¥, báº¡n khÃ´ng thá»ƒ cháº¡y `create` náº¿u object Ä‘Ã£ tá»“n táº¡i (sáº½ bÃ¡o lá»—i), vÃ  khÃ´ng thá»ƒ cháº¡y `replace` náº¿u object chÆ°a tá»“n táº¡i.

#### b. CÃ¡ch tiáº¿p cáº­n Khai bÃ¡o (Declarative Approach) - "ChÃ¢n Ã¡i" cá»§a Kubernetes â¤ï¸

ÄÃ¢y lÃ  phÆ°Æ¡ng phÃ¡p Ä‘Æ°á»£c khuyáº¿n khÃ­ch sá»­ dá»¥ng trong thá»±c táº¿.

- **Lá»‡nh duy nháº¥t:** **`kubectl apply -f <file.yaml hoáº·c thÆ° má»¥c>`**
- **CÃ¡ch hoáº¡t Ä‘á»™ng:**
  1. Báº¡n Ä‘á»‹nh nghÄ©a **tráº¡ng thÃ¡i cuá»‘i cÃ¹ng mong muá»‘n** cho toÃ n bá»™ á»©ng dá»¥ng cá»§a mÃ¬nh trong má»™t hoáº·c nhiá»u file YAML.
  2. Báº¡n **luÃ´n luÃ´n** cháº¡y lá»‡nh `kubectl apply -f ...`.
- **Sá»± "thÃ´ng minh" cá»§a `apply`:**
  - NÃ³ sáº½ tá»± so sÃ¡nh tráº¡ng thÃ¡i báº¡n khai bÃ¡o trong file vá»›i tráº¡ng thÃ¡i hiá»‡n táº¡i trÃªn cá»¥m.
  - Náº¿u object chÆ°a tá»“n táº¡i, nÃ³ sáº½ **táº¡o má»›i**.
  - Náº¿u object Ä‘Ã£ tá»“n táº¡i, nÃ³ sáº½ tÃ­nh toÃ¡n sá»± khÃ¡c biá»‡t vÃ  **chá»‰ cáº­p nháº­t nhá»¯ng thay Ä‘á»•i cáº§n thiáº¿t**.
  - NÃ³ khÃ´ng bao giá» bÃ¡o lá»—i "object Ä‘Ã£ tá»“n táº¡i". Báº¡n chá»‰ cáº§n "khai bÃ¡o" vÃ  `apply`, Kubernetes sáº½ lo pháº§n cÃ²n láº¡i.

---

### 3. Máº¹o cho Ká»³ thi CKA ğŸ“

Trong ká»³ thi CKA, thá»i gian lÃ  vÃ ng, vÃ¬ váº­y báº¡n cáº§n linh hoáº¡t:

- **Äá»ƒ táº¡o nhanh cÃ¡c object Ä‘Æ¡n giáº£n** (Pod, Deployment vá»›i má»™t image duy nháº¥t): HÃ£y dÃ¹ng cÃ¡c lá»‡nh má»‡nh lá»‡nh nhÆ° **`kubectl run`** hoáº·c **`kubectl create deployment`**.
- **Äá»ƒ sá»­a nhanh má»™t thuá»™c tÃ­nh** cá»§a object Ä‘ang cÃ³: **`kubectl edit`** lÃ  lá»±a chá»n nhanh nháº¥t.
- **Vá»›i cÃ¡c yÃªu cáº§u phá»©c táº¡p** (táº¡o Pod nhiá»u container, Ä‘á»‹nh nghÄ©a volumes, env-vars,...): Tá»‘t nháº¥t lÃ  nÃªn **táº¡o má»™t file YAML**. CÃ¡ch nÃ y giÃºp báº¡n dá»… dÃ ng kiá»ƒm tra, sá»­a lá»—i vÃ  Ã¡p dá»¥ng láº¡i náº¿u cáº§n. Khi Ä‘Ã³, dÃ¹ng **`kubectl apply -f`** lÃ  má»™t lá»±a chá»n ráº¥t tá»‘t.

#### **Reference:**

[https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands](https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands)

[https://kubernetes.io/docs/reference/kubectl/conventions/](https://kubernetes.io/docs/reference/kubectl/conventions/)

---

Máº·c dÃ¹ cÃ¡ch lÃ m khai bÃ¡o (dÃ¹ng file YAML) lÃ  chuáº©n trong thá»±c táº¿, nhÆ°ng trong ká»³ thi CKA, nhá»¯ng lá»‡nh nÃ y sáº½ giÃºp báº¡n tiáº¿t kiá»‡m cá»±c ká»³ nhiá»u thá»i gian quÃ½ bÃ¡u\!

---

### 1\. Hai "Báº£o bá»‘i" Cáº§n Nhá»›: `--dry-run` vÃ  `-o yaml`

TrÆ°á»›c khi Ä‘i vÃ o tá»«ng lá»‡nh cá»¥ thá»ƒ, báº¡n cáº§n náº¯m vá»¯ng hai tÃ¹y chá»n (options) "tháº§n thÃ¡nh" nÃ y:

- **`--dry-run=client`**:

  - **NghÄ©a lÃ :** "Cháº¡y thá»­ thÃ´i, Ä‘á»«ng táº¡o tháº­t nhÃ©\!".
  - `kubectl` sáº½ kiá»ƒm tra cÃº phÃ¡p lá»‡nh cá»§a báº¡n vÃ  cho báº¡n biáº¿t liá»‡u tÃ i nguyÃªn cÃ³ thá»ƒ Ä‘Æ°á»£c táº¡o hay khÃ´ng, nhÆ°ng nÃ³ **sáº½ khÃ´ng thá»±c sá»± táº¡o ra báº¥t ká»³ tÃ i nguyÃªn nÃ o** trong cá»¥m.

- **`-o yaml`**:

  - **NghÄ©a lÃ :** "In káº¿t quáº£ ra mÃ n hÃ¬nh dÆ°á»›i Ä‘á»‹nh dáº¡ng YAML nhÃ©\!".

> **ğŸš€ Combo Tháº§n thÃ¡nh:** Káº¿t há»£p hai tÃ¹y chá»n nÃ y, báº¡n cÃ³ thá»ƒ **táº¡o ra má»™t file template YAML má»™t cÃ¡ch siÃªu tá»‘c** mÃ  khÃ´ng cáº§n pháº£i viáº¿t tá»« Ä‘áº§u.
>
> ```bash
> # CÃº phÃ¡p
> kubectl <lá»‡nh-táº¡o-tÃ i-nguyÃªn> --dry-run=client -o yaml > ten-file.yaml
> ```
>
> Sau Ä‘Ã³, báº¡n chá»‰ cáº§n má»Ÿ file `ten-file.yaml` ra vÃ  chá»‰nh sá»­a thÃªm cho cÃ¡c yÃªu cáº§u phá»©c táº¡p.

---

### 2\. CÃ¡c Lá»‡nh Má»‡nh lá»‡nh (Imperative Commands) ThÃ´ng dá»¥ng

#### a. Vá»›i `Pod`

- **Táº¡o nhanh má»™t NGINX Pod:**
  ```bash
  kubectl run nginx --image=nginx
  ```
- **Táº¡o file YAML cho Pod mÃ  khÃ´ng táº¡o Pod tháº­t:**
  ```bash
  kubectl run nginx --image=nginx --dry-run=client -o yaml
  ```

#### b. Vá»›i `Deployment`

- **Táº¡o má»™t Deployment:**
  ```bash
  kubectl create deployment nginx --image=nginx
  ```
- **Táº¡o Deployment vá»›i 4 báº£n sao (replicas):**
  ```bash
  kubectl create deployment nginx --image=nginx --replicas=4
  ```
- **Scale má»™t Deployment Ä‘ang cÃ³:**
  ```bash
  kubectl scale deployment nginx --replicas=4
  ```
- **Táº¡o file YAML cho Deployment:**
  ```bash
  kubectl create deployment nginx --image=nginx --dry-run=client -o yaml
  ```

#### c. Vá»›i `Service` (Pháº§n cáº§n lÆ°u Ã½)

Táº¡o Service báº±ng lá»‡nh cÃ³ hÆ¡i phá»©c táº¡p hÆ¡n má»™t chÃºt vÃ¬ cÃ³ hai lá»‡nh chÃ­nh vá»›i nhá»¯ng Æ°u vÃ  nhÆ°á»£c Ä‘iá»ƒm riÃªng:

- **CÃ¡ch 1: `kubectl expose` (Khuyáº¿n khÃ­ch dÃ¹ng lÃ m Ä‘iá»ƒm khá»Ÿi Ä‘áº§u)**

  - **Lá»‡nh:** `kubectl expose pod redis --port=6379 --name redis-service`
  - âœ… **Æ¯u Ä‘iá»ƒm:** NÃ³ sáº½ **tá»± Ä‘á»™ng sá»­ dá»¥ng `labels` cá»§a Pod lÃ m `selector`** cho Service. ÄÃ¢y thÆ°á»ng lÃ  Ä‘iá»u báº¡n muá»‘n.
  - âŒ **NhÆ°á»£c Ä‘iá»ƒm:** Báº¡n **khÃ´ng thá»ƒ chá»‰ Ä‘á»‹nh `nodePort`** trá»±c tiáº¿p báº±ng lá»‡nh nÃ y.

- **CÃ¡ch 2: `kubectl create service`**

  - **Lá»‡nh:** `kubectl create service nodeport nginx --tcp=80:80 --node-port=30080`
  - âœ… **Æ¯u Ä‘iá»ƒm:** Báº¡n cÃ³ thá»ƒ chá»‰ Ä‘á»‹nh cÃ¡c thÃ´ng sá»‘ chi tiáº¿t nhÆ° `node-port`.
  - âŒ **NhÆ°á»£c Ä‘iá»ƒm:** NÃ³ **khÃ´ng tá»± Ä‘á»™ng láº¥y `selector` tá»« `labels` cá»§a Pod**. Thay vÃ o Ä‘Ã³, nÃ³ sáº½ giáº£ Ä‘á»‹nh má»™t selector máº·c Ä‘á»‹nh (vÃ­ dá»¥: `app=nginx`). Náº¿u Pod cá»§a báº¡n cÃ³ label khÃ¡c, Service sáº½ khÃ´ng hoáº¡t Ä‘á»™ng.

> **ğŸ’¡ Chiáº¿n lÆ°á»£c Ä‘á» xuáº¥t:**
>
> HÃ£y báº¯t Ä‘áº§u vá»›i lá»‡nh **`kubectl expose`**. Náº¿u báº¡n cáº§n chá»‰ Ä‘á»‹nh cÃ¡c trÆ°á»ng nÃ¢ng cao nhÆ° `nodePort`, hÃ£y dÃ¹ng `expose` vá»›i combo `--dry-run=client -o yaml` Ä‘á»ƒ táº¡o ra má»™t file YAML cÆ¡ báº£n (Ä‘Ã£ cÃ³ sáºµn `selector` Ä‘Ãºng). Sau Ä‘Ã³, báº¡n chá»‰ cáº§n má»Ÿ file Ä‘Ã³ ra vÃ  thÃªm dÃ²ng `nodePort` vÃ o rá»“i má»›i táº¡o Service.

---

### 3\. "Chá»‘t háº¡" Chiáº¿n lÆ°á»£c thi ğŸ“

- Äá»‘i vá»›i cÃ¡c yÃªu cáº§u **táº¡o tÃ i nguyÃªn Ä‘Æ¡n giáº£n**, hÃ£y dÃ¹ng cÃ¡c lá»‡nh má»‡nh lá»‡nh nhÆ° `kubectl run`, `kubectl create deployment` Ä‘á»ƒ tiáº¿t kiá»‡m thá»i gian.
- HÃ£y thÃ nh tháº¡o "combo tháº§n thÃ¡nh" **`--dry-run=client -o yaml`** Ä‘á»ƒ táº¡o nhanh cÃ¡c file template YAML khi cáº§n giáº£i quyáº¿t cÃ¡c yÃªu cáº§u phá»©c táº¡p hÆ¡n.
- Khi táº¡o **Service**, hÃ£y Æ°u tiÃªn dÃ¹ng `kubectl expose` Ä‘á»ƒ Ä‘áº£m báº£o `selector` Ä‘Æ°á»£c thiáº¿t láº­p chÃ­nh xÃ¡c.

Náº¯m vá»¯ng cÃ¡c lá»‡nh nÃ y sáº½ lÃ  má»™t lá»£i tháº¿ cá»±c lá»›n, giÃºp báº¡n hoÃ n thÃ nh cÃ¡c bÃ i thá»±c hÃ nh trong ká»³ thi CKA má»™t cÃ¡ch nhanh chÃ³ng vÃ  chÃ­nh xÃ¡c. ChÃºc báº¡n má»™t buá»•i chiá»u há»c táº­p hiá»‡u quáº£\!
