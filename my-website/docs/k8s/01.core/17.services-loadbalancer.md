### 1. BÃ i toÃ¡n: Tá»« `NodePort` Ä‘áº¿n má»™t URL thÃ¢n thiá»‡n vá»›i ngÆ°á»i dÃ¹ng ğŸ¤”

á» bÃ i trÆ°á»›c, chÃºng ta Ä‘Ã£ dÃ¹ng `NodePort` Ä‘á»ƒ truy cáº­p á»©ng dá»¥ng. Tuy nhiÃªn, nÃ³ cÃ³ má»™t váº¥n Ä‘á» lá»›n:

- Äá»ƒ truy cáº­p, báº¡n pháº£i dÃ¹ng Ä‘á»‹a chá»‰ `<IP-cá»§a-Node>:<nodePort>`.
- Náº¿u cá»¥m cá»§a báº¡n cÃ³ 4 node, báº¡n sáº½ cÃ³ tá»›i 4 Ä‘á»‹a chá»‰ IP khÃ¡c nhau Ä‘á»ƒ truy cáº­p cÃ¹ng má»™t á»©ng dá»¥ng.
- Báº¡n khÃ´ng thá»ƒ Ä‘Æ°a cho ngÆ°á»i dÃ¹ng cuá»‘i má»™t danh sÃ¡ch cÃ¡c IP nhÆ° váº­y. CÃ¡i há» cáº§n lÃ  má»™t **URL duy nháº¥t**, thÃ¢n thiá»‡n, vÃ­ dá»¥: `votingapp.com`.

**Giáº£i phÃ¡p truyá»n thá»‘ng lÃ  gÃ¬?** Báº¡n cÃ³ thá»ƒ tá»± dá»±ng má»™t mÃ¡y chá»§ VM riÃªng, cÃ i Ä‘áº·t má»™t bá»™ cÃ¢n báº±ng táº£i nhÆ° Nginx hoáº·c HAProxy, rá»“i cáº¥u hÃ¬nh nÃ³ Ä‘á»ƒ trá» Ä‘áº¿n cÃ¡c node trong cá»¥m Kubernetes. NhÆ°ng cÃ¡ch nÃ y ráº¥t thá»§ cÃ´ng, tá»‘n cÃ´ng sá»©c cÃ i Ä‘áº·t vÃ  báº£o trÃ¬.

---

### 2. `LoadBalancer` Service - "Cáº§u ná»‘i" ra Internet ğŸŒ‰

![1751442203242](image/17.services-loadbalancer/1751442203242.png)

Kubernetes cung cáº¥p má»™t giáº£i phÃ¡p "xá»‹n" hÆ¡n nhiá»u, Ä‘Ã³ lÃ  Service loáº¡i `LoadBalancer`.

- **NÃ³ lÃ  gÃ¬?** ÄÃ¢y lÃ  loáº¡i Service Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tá»± Ä‘á»™ng tÃ­ch há»£p vá»›i cÃ¡c bá»™ cÃ¢n báº±ng táº£i cá»§a nhá»¯ng nhÃ  cung cáº¥p dá»‹ch vá»¥ Ä‘Ã¡m mÃ¢y (cloud provider).
- **Báº¡n cáº§n lÃ m gÃ¬?** Ráº¥t Ä‘Æ¡n giáº£n, báº¡n chá»‰ cáº§n khai bÃ¡o `type: LoadBalancer` trong file YAML cá»§a Service.

---

### 3. "PhÃ©p mÃ u" Ä‘áº±ng sau `type: LoadBalancer` âœ¨

Khi báº¡n táº¡o má»™t Service vá»›i `type: LoadBalancer` trÃªn má»™t ná»n táº£ng cloud Ä‘Æ°á»£c há»— trá»£, má»™t chuá»—i hÃ nh Ä‘á»™ng tá»± Ä‘á»™ng sáº½ xáº£y ra:

1. Kubernetes váº«n sáº½ táº¡o ra má»™t **`ClusterIP`** Service Ä‘á»ƒ giao tiáº¿p ná»™i bá»™.
2. NÃ³ cÅ©ng sáº½ táº¡o ra má»™t **`NodePort`** Service Ä‘á»ƒ má»Ÿ má»™t cá»•ng trÃªn má»—i node.
3. **Äiá»u quan trá»ng nháº¥t:** Kubernetes sáº½ gá»­i má»™t yÃªu cáº§u API Ä‘áº¿n nhÃ  cung cáº¥p cloud (vÃ­ dá»¥: AWS, Google Cloud, Azure).
4. NhÃ  cung cáº¥p cloud sáº½ tá»± Ä‘á»™ng táº¡o ra má»™t **Bá»™ cÃ¢n báº±ng táº£i máº¡ng bÃªn ngoÃ i (External Network Load Balancer)**.
5. Load Balancer nÃ y sáº½ cÃ³ má»™t Ä‘á»‹a chá»‰ IP public, cá»‘ Ä‘á»‹nh vÃ  Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘á»ƒ tá»± Ä‘á»™ng chuyá»ƒn tiáº¿p táº¥t cáº£ traffic tá»« Internet vÃ o cÃ¡i `NodePort` Ä‘Ã£ Ä‘Æ°á»£c má»Ÿ trÃªn cÃ¡c node cá»§a báº¡n.

Káº¿t quáº£ lÃ  ngÆ°á»i dÃ¹ng chá»‰ cáº§n truy cáº­p vÃ o Ä‘á»‹a chá»‰ IP public cá»§a Load Balancer nÃ y lÃ  cÃ³ thá»ƒ vÃ o Ä‘Æ°á»£c á»©ng dá»¥ng cá»§a báº¡n.

---

### 4. Äiá»ƒm "ChÃ­ máº¡ng" cáº§n nhá»›: Phá»¥ thuá»™c vÃ o NhÃ  cung cáº¥p Cloud â˜ï¸âš ï¸

- TÃ­nh nÄƒng nÃ y **CHá»ˆ HOáº T Äá»˜NG** trÃªn cÃ¡c ná»n táº£ng cloud Ä‘Æ°á»£c Kubernetes há»— trá»£ (GCP, AWS, Azure lÃ  cÃ¡c vÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh).
- Náº¿u báº¡n khai bÃ¡o `type: LoadBalancer` trong má»™t mÃ´i trÆ°á»ng khÃ´ng Ä‘Æ°á»£c há»— trá»£ (vÃ­ dá»¥: má»™t cá»¥m Kubernetes báº¡n tá»± dá»±ng trÃªn mÃ¡y áº£o VirtualBox á»Ÿ nhÃ ), nÃ³ sáº½ **chá»‰ hoáº¡t Ä‘á»™ng nhÆ° má»™t `NodePort` Service**. Sáº½ khÃ´ng cÃ³ external load balancer nÃ o Ä‘Æ°á»£c táº¡o ra cáº£.

---

### 5. "Chá»‘t háº¡" cho Ká»³ thi CKA ğŸ“

- Sá»­ dá»¥ng `type: LoadBalancer` lÃ  cÃ¡ch tiÃªu chuáº©n Ä‘á»ƒ "Ä‘Æ°a" má»™t á»©ng dá»¥ng trong Kubernetes ra Internet vá»›i má»™t **Ä‘á»‹a chá»‰ IP duy nháº¥t vÃ  á»•n Ä‘á»‹nh**.
- TÃ­nh nÄƒng nÃ y phá»¥ thuá»™c vÃ o sá»± **tÃ­ch há»£p vá»›i má»™t nhÃ  cung cáº¥p cloud Ä‘Æ°á»£c há»— trá»£**.
- Trong mÃ´i trÆ°á»ng khÃ´ng Ä‘Æ°á»£c há»— trá»£, `LoadBalancer` sáº½ hoáº¡t Ä‘á»™ng giá»‘ng há»‡t nhÆ° `NodePort`.
- Vá» báº£n cháº¥t, khi báº¡n táº¡o má»™t `LoadBalancer` Service, nÃ³ cÅ©ng Ä‘á»“ng thá»i táº¡o ra cáº£ `NodePort` vÃ  `ClusterIP` Service bÃªn dÆ°á»›i.
