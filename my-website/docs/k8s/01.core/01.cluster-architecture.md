## Kiáº¿n trÃºc Kubernetes qua phÃ©p so sÃ¡nh TÃ u Thuyá»n

Má»¥c Ä‘Ã­ch cá»§a Kubernetes lÃ  tá»± Ä‘á»™ng hÃ³a viá»‡c triá»ƒn khai vÃ  quáº£n lÃ½ cÃ¡c á»©ng dá»¥ng cá»§a báº¡n dÆ°á»›i dáº¡ng **container**. HÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n Ä‘ang quáº£n lÃ½ má»™t háº¡m Ä‘á»™i tÃ u biá»ƒn khá»•ng lá»“:

- **TÃ u HÃ ng (Cargo Ships) ğŸš¢:** ÄÃ¢y lÃ  nhá»¯ng con tÃ u lÃ m cÃ´ng viá»‡c thá»±c táº¿ - chuyÃªn chá»Ÿ cÃ¡c container (á»©ng dá»¥ng cá»§a báº¡n). Trong Kubernetes, chÃºng chÃ­nh lÃ  cÃ¡c **Worker Node**.
- **TÃ u Chá»‰ Huy (Control Ships)** ÄÃ¢y lÃ  nhá»¯ng con tÃ u Ä‘áº§u nÃ£o, khÃ´ng chá»Ÿ hÃ ng mÃ  lÃ m nhiá»‡m vá»¥ quáº£n lÃ½, giÃ¡m sÃ¡t, vÃ  Ä‘iá»u phá»‘i toÃ n bá»™ háº¡m Ä‘á»™i tÃ u hÃ ng. Trong Kubernetes, Ä‘Ã¢y chÃ­nh lÃ  **Master Node**.

## Má»™t cá»¥m Kubernetes (Kubernetes cluster) bao gá»“m má»™t hoáº·c nhiá»u Master Node vÃ  nhiá»u Worker Node.

## BÃªn trong "TÃ u Chá»‰ Huy" (Master Node Control Plane)

Master Node lÃ  bá»™ nÃ£o cá»§a cáº£ cá»¥m, nÃ³ Ä‘iá»u hÃ nh má»i thá»© thÃ´ng qua má»™t bá»™ cÃ¡c thÃ nh pháº§n gá»i lÃ  **Control Plane**.

### `etcd` - Kho Dá»¯ liá»‡u cá»§a Háº¡m Ä‘á»™i

- **So sÃ¡nh:** Giá»‘ng nhÆ° cuá»‘n sá»• nháº­t kÃ½ khá»•ng lá»“ cá»§a háº¡m Ä‘á»™i, lÆ°u trá»¯ má»i thÃ´ng tin: cÃ³ bao nhiÃªu con tÃ u, tÃ u nÃ o Ä‘ang chá»Ÿ container gÃ¬, container Ä‘Æ°á»£c xáº¿p lÃªn lÃºc nÃ o, v.v.
- **Thá»±c táº¿:** **`etcd`** lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u dáº¡ng key-value cÃ³ tÃ­nh sáºµn sÃ ng cao (highly available). NÃ³ lÆ°u trá»¯ **toÃ n bá»™ tráº¡ng thÃ¡i vÃ  cáº¥u hÃ¬nh** cá»§a cá»¥m Kubernetes. Má»i thÃ´ng tin vá» nodes, pods (containers), services,... Ä‘á»u náº±m trong `etcd`.

### `kube-scheduler` - NgÆ°á»i Äiá»u Phá»‘i Xáº¿p Dá»¡

- **So sÃ¡nh:** Giá»‘ng nhÆ° nhá»¯ng chiáº¿c cáº§n cáº©u thÃ´ng minh á»Ÿ báº¿n cáº£ng. Khi cÃ³ má»™t container cáº§n xáº¿p lÃªn tÃ u, cáº§n cáº©u sáº½ xÃ¡c Ä‘á»‹nh con tÃ u nÃ o lÃ  phÃ¹ há»£p nháº¥t dá»±a trÃªn kÃ­ch thÆ°á»›c, sá»©c chá»©a cÃ²n láº¡i, loáº¡i hÃ ng Ä‘Æ°á»£c phÃ©p chá»Ÿ, v.v.
- **Thá»±c táº¿:** **`kube-scheduler`** cÃ³ nhiá»‡m vá»¥ tÃ¬m má»™t **Worker Node** phÃ¹ há»£p nháº¥t Ä‘á»ƒ cháº¡y má»™t Pod (má»™t hoáº·c nhiá»u container) má»›i Ä‘Æ°á»£c yÃªu cáº§u. NÃ³ xem xÃ©t cÃ¡c yáº¿u tá»‘ nhÆ° tÃ i nguyÃªn yÃªu cáº§u cá»§a Pod (CPU, memory) vÃ  tÃ i nguyÃªn cÃ²n trá»‘ng cá»§a cÃ¡c Node.

### `kube-controller-manager` - Ban Quáº£n lÃ½ cÃ¡c PhÃ²ng ban

- **So sÃ¡nh:** TÃ u chá»‰ huy cÃ³ nhiá»u phÃ²ng ban chuyÃªn trÃ¡ch: phÃ²ng Ä‘iá»u hÃ nh lo viá»‡c váº­n táº£i, phÃ²ng hÃ ng hÃ³a lo cÃ¡c container, phÃ²ng IT lo viá»‡c liÃªn láº¡c.
- **Thá»±c táº¿:** **`kube-controller-manager`** quáº£n lÃ½ nhiá»u "bá»™ Ä‘iá»u khiá»ƒn" (controllers) khÃ¡c nhau, má»—i controller lÃ  má»™t vÃ²ng láº·p theo dÃµi tráº¡ng thÃ¡i cá»§a cá»¥m vÃ  cá»‘ gáº¯ng Ä‘Æ°a nÃ³ vá» tráº¡ng thÃ¡i mong muá»‘n.
  - **Node Controller:** ChÄƒm sÃ³c cÃ¡c Node. NÃ³ chá»‹u trÃ¡ch nhiá»‡m khi má»™t Node má»›i tham gia vÃ o cá»¥m, hoáº·c khi má»™t Node "cháº¿t" hoáº·c khÃ´ng thá»ƒ truy cáº­p.
  - **Replication Controller:** Äáº£m báº£o sá»‘ lÆ°á»£ng báº£n sao (replicas) cá»§a má»™t á»©ng dá»¥ng luÃ´n Ä‘Ãºng nhÆ° báº¡n Ä‘Ã£ khai bÃ¡o.

### `kube-api-server` - "Tá»•ng ÄÃ i" Giao tiáº¿p Trung tÃ¢m

- **So sÃ¡nh:** ÄÃ¢y lÃ  trung tÃ¢m chá»‰ huy, nÆ¡i táº¥t cáº£ cÃ¡c phÃ²ng ban, cÃ¡c tÃ u hÃ ng, vÃ  cáº£ ngÆ°á»i quáº£n lÃ½ tá»« bÃªn ngoÃ i liÃªn láº¡c vá»›i nhau. Má»i má»‡nh lá»‡nh Ä‘á»u Ä‘i qua Ä‘Ã¢y.
- **Thá»±c táº¿:** **`kube-api-server`** lÃ  thÃ nh pháº§n trung tÃ¢m vÃ  quan trá»ng nháº¥t. NÃ³ phÆ¡i bÃ y ra **Kubernetes API**. Má»i tÆ°Æ¡ng tÃ¡c vá»›i cá»¥m Kubernetes Ä‘á»u pháº£i thÃ´ng qua API Server.
  - NgÆ°á»i dÃ¹ng (dÃ¹ng `kubectl`), cÃ¡c controller, vÃ  cáº£ cÃ¡c worker node Ä‘á»u nÃ³i chuyá»‡n vá»›i nhau thÃ´ng qua `kube-api-server`.

---

## TrÃªn "TÃ u HÃ ng" (Worker Node)

ÄÃ¢y lÃ  nÆ¡i cÃ¡c container á»©ng dá»¥ng cá»§a báº¡n thá»±c sá»± cháº¡y. Má»—i Worker Node cÅ©ng cÃ³ cÃ¡c thÃ nh pháº§n quan trá»ng riÃªng.

### Container Runtime Engine (vÃ­ dá»¥: Docker) - Äá»™ng cÆ¡ Cháº¡y Container

- **So sÃ¡nh:** Äá»ƒ chá»Ÿ Ä‘Æ°á»£c container, con tÃ u pháº£i Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tÆ°Æ¡ng thÃ­ch vá»›i container.
- **Thá»±c táº¿:** ÄÃ¢y lÃ  pháº§n má»m chá»‹u trÃ¡ch nhiá»‡m **cháº¡y cÃ¡c container**. **Docker** lÃ  má»™t lá»±a chá»n phá»• biáº¿n, nhÆ°ng Kubernetes cÅ©ng há»— trá»£ cÃ¡c runtime khÃ¡c nhÆ° **ContainerD**, **Rocket (rkt)**. NÃ³ pháº£i Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn táº¥t cáº£ cÃ¡c node trong cá»¥m.

### `kubelet` - Thuyá»n trÆ°á»Ÿng cá»§a TÃ u HÃ ng

- **So sÃ¡nh:** Má»—i tÃ u hÃ ng cÃ³ má»™t thuyá»n trÆ°á»Ÿng, chá»‹u trÃ¡ch nhiá»‡m quáº£n lÃ½ má»i hoáº¡t Ä‘á»™ng trÃªn tÃ u mÃ¬nh. Thuyá»n trÆ°á»Ÿng nháº­n lá»‡nh tá»« tÃ u chá»‰ huy, xáº¿p dá»¡ container theo yÃªu cáº§u, vÃ  bÃ¡o cÃ¡o tÃ¬nh tráº¡ng cá»§a tÃ u vÃ  hÃ ng hÃ³a vá» trung tÃ¢m.
- **Thá»±c táº¿:** **`kubelet`** lÃ  má»™t agent cháº¡y trÃªn má»—i Worker Node. NÃ³ láº¯ng nghe chá»‰ thá»‹ tá»« `kube-api-server` vÃ  Ä‘áº£m báº£o ráº±ng cÃ¡c container Ä‘Æ°á»£c mÃ´ táº£ trong cÃ¡c Pod Ä‘ang cháº¡y vÃ  khá»e máº¡nh trÃªn node cá»§a nÃ³. NÃ³ cÅ©ng gá»­i bÃ¡o cÃ¡o tráº¡ng thÃ¡i cá»§a node vÃ  cÃ¡c container vá» cho Master Node.

### `kube-proxy` - NgÆ°á»i Dáº«n Lá»‘i Máº¡ng

- **So sÃ¡nh:** CÃ¡c á»©ng dá»¥ng trÃªn cÃ¡c tÃ u hÃ ng khÃ¡c nhau cáº§n nÃ³i chuyá»‡n Ä‘Æ°á»£c vá»›i nhau (vÃ­ dá»¥: web server trÃªn tÃ u A cáº§n gá»i Ä‘áº¿n database trÃªn tÃ u B). `kube-proxy` táº¡o ra cÃ¡c tuyáº¿n Ä‘Æ°á»ng liÃªn láº¡c Ä‘Ã³.
- **Thá»±c táº¿:** **`kube-proxy`** lÃ  má»™t network proxy cháº¡y trÃªn má»—i node. NÃ³ duy trÃ¬ cÃ¡c quy táº¯c máº¡ng (network rules) trÃªn cÃ¡c node, cho phÃ©p giao tiáº¿p máº¡ng Ä‘áº¿n cÃ¡c Pod tá»« bÃªn trong hoáº·c bÃªn ngoÃ i cá»¥m. NÃ³ lÃ  thÃ nh pháº§n chÃ­nh giÃºp thá»±c hiá»‡n cÆ¡ cháº¿ **Service Discovery** trong Kubernetes.

---

## TÃ³m táº¯t Kiáº¿n trÃºc


- **Master Node (Control Plane):**
  - `etcd` (LÆ°u trá»¯ tráº¡ng thÃ¡i)
  - `kube-scheduler` (Chá»n Node cho Pod)
  - `kube-controller-manager` (Quáº£n lÃ½ cÃ¡c controller)
  - `kube-api-server` (Cá»•ng giao tiáº¿p chÃ­nh)
- **Worker Node:**
  - `kubelet` (Agent quáº£n lÃ½ container trÃªn Node)
  - `kube-proxy` (Quáº£n lÃ½ máº¡ng cho Node)
  - `Container Runtime` (Pháº§n má»m cháº¡y container)

---

## "Chá»‘t háº¡" cho Ká»³ thi ğŸ“

- Náº¯m vá»¯ng sá»± khÃ¡c biá»‡t giá»¯a **Master Node** vÃ  **Worker Node**.
- Hiá»ƒu rÃµ **vai trÃ² vÃ  trÃ¡ch nhiá»‡m** cá»§a tá»«ng thÃ nh pháº§n cá»‘t lÃµi: `etcd`, `api-server`, `scheduler`, `controller-manager`, `kubelet`, `kube-proxy`.
- HÃ£y nhá»› ráº±ng má»i giao tiáº¿p Ä‘á»u Ä‘i qua **`kube-api-server`**.
- **`kubelet`** lÃ  "tay chÃ¢n" cá»§a Master trÃªn má»—i Worker Node.

Hy vá»ng pháº§n giáº£i thÃ­ch chi tiáº¿t nÃ y giÃºp báº¡n hiá»ƒu rÃµ hÆ¡n vá» kiáº¿n trÃºc cá»§a Kubernetes. ChÃºc báº¡n má»™t cuá»‘i tuáº§n vui váº» vÃ  há»c táº­p hiá»‡u quáº£!
